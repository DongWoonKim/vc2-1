name: PR ìë™ ëŒ“ê¸€

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  comment:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      contents: read
      
    steps:
    - uses: actions/checkout@v4
    
    - name: PR ì •ë³´ ë¶„ì„
      id: pr-info
      run: |
        echo "files_changed=$(git diff --name-only origin/${{ github.base_ref }}...HEAD | wc -l)" >> $GITHUB_OUTPUT
        echo "lines_added=$(git diff --numstat origin/${{ github.base_ref }}...HEAD | awk '{sum+=$1} END {print sum}')" >> $GITHUB_OUTPUT
        echo "lines_deleted=$(git diff --numstat origin/${{ github.base_ref }}...HEAD | awk '{sum+=$2} END {print sum}')" >> $GITHUB_OUTPUT
        
        # ì»´í¬ë„ŒíŠ¸ ë¶„ì„
        if git diff --name-only origin/${{ github.base_ref }}...HEAD | grep -q "^backend/"; then
          echo "has_backend=true" >> $GITHUB_OUTPUT
        fi
        if git diff --name-only origin/${{ github.base_ref }}...HEAD | grep -q "^frontend/"; then
          echo "has_frontend=true" >> $GITHUB_OUTPUT
        fi
        if git diff --name-only origin/${{ github.base_ref }}...HEAD | grep -q "\.md$"; then
          echo "has_docs=true" >> $GITHUB_OUTPUT
        fi
        
    - name: PR ëŒ“ê¸€ ì‘ì„±
      uses: actions/github-script@v7
      with:
        script: |
          const comment = `## ğŸš€ PR ìë™ ë¶„ì„ ë¦¬í¬íŠ¸
          
          ### ğŸ“Š ë³€ê²½ ì‚¬í•­ í†µê³„
          - **ë³€ê²½ëœ íŒŒì¼**: ${{ steps.pr-info.outputs.files_changed }}ê°œ
          - **ì¶”ê°€ëœ ë¼ì¸**: ${{ steps.pr-info.outputs.lines_added }}ì¤„
          - **ì‚­ì œëœ ë¼ì¸**: ${{ steps.pr-info.outputs.lines_deleted }}ì¤„
          
          ### ğŸ” ì»´í¬ë„ŒíŠ¸ ë¶„ì„
          ${{ steps.pr-info.outputs.has_backend == 'true' && '- âœ… **Backend** ë³€ê²½ì‚¬í•­ í¬í•¨' || '' }}
          ${{ steps.pr-info.outputs.has_frontend == 'true' && '- âœ… **Frontend** ë³€ê²½ì‚¬í•­ í¬í•¨' || '' }}
          ${{ steps.pr-info.outputs.has_docs == 'true' && '- âœ… **Documentation** ë³€ê²½ì‚¬í•­ í¬í•¨' || '' }}
          
          ### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸
          - [ ] ë¡œì»¬ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
          - [ ] ì½”ë“œ ë¦¬ë·° ì¤€ë¹„ ì™„ë£Œ
          - [ ] ê´€ë ¨ ì´ìŠˆ ì—°ê²° í™•ì¸
          - [ ] ë¬¸ì„œ ì—…ë°ì´íŠ¸ í™•ì¸ (í•„ìš”í•œ ê²½ìš°)
          
          ### ğŸ¤– ìë™í™” ìƒíƒœ
          - í…ŒìŠ¤íŠ¸ ìë™ ì‹¤í–‰: ì§„í–‰ ì¤‘...
          - ë¼ë²¨ ìë™ í• ë‹¹: ì™„ë£Œ ì˜ˆì •
          - ë¦¬ë·°ì–´ ìë™ í• ë‹¹: ì™„ë£Œ ì˜ˆì •
          
          ---
          *ì´ ëŒ“ê¸€ì€ GitHub Actionsì— ì˜í•´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*`;
          
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: comment
          }); 